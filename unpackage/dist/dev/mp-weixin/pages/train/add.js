require("../../common/manifest.js");
require("../../common/vendor.js");
global.webpackJsonp([10],{34:function(t,e,i){"use strict";var s=a(i(1)),n=a(i(35));function a(t){return t&&t.__esModule?t:{default:t}}Page((0,s.default)(n.default))},35:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i(37),n=i.n(s),a=i(41),o=!1;var r=function(t){o||i(36)},c=i(0)(n.a,a.a,r,null,null);c.options.__file="C:\\Users\\Admin\\Desktop\\devFire\\pages\\train\\add.vue",c.esModule&&Object.keys(c.esModule).some(function(t){return"default"!==t&&"__"!==t.substr(0,2)})&&console.error("named exports are not supported in *.vue files."),c.options.functional&&console.error("[vue-loader] add.vue: functional components are not supported with templates, they should use render functions."),e.default=c.exports},36:function(t,e){},37:function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var s=r(i(38)),n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t},a=r(i(3)),o=i(4);function r(t){return t&&t.__esModule?t:{default:t}}e.default={data:function(){return{isFix:!1,isshow:!1,src:"",showVideo:!1,content:"",comlist:[],imageList:[],imgurlarr:[],lifevideo:"",lifecat:"",pushid:""}},computed:n({},(0,o.mapState)(["user"])),onUnload:function(){this.src=""},methods:{islogin:function(){null!==this.user.user||t.reLaunch({url:"../../pages/manage/login"})},getcomlist:function(){var e=this;t.request({url:a.default.hosturl+"index/getmessage.html",method:"POST",data:{token:this.user.user.token},header:{"content-type":"application/x-www-form-urlencoded"},success:function(i){0==i.data.code?e.comlist=i.data.list:t.showToast({icon:"none",title:"出错啦，请联系客服"})},fail:function(){t.showToast({icon:"none",title:"网络错误"})}})},uploadImage:function(e,i){var s=this;t.showLoading({title:"上传中..",mask:!0});t.uploadFile({url:a.default.hosturl+"Upload/uploadfile.html",filePath:e,name:"file",formData:{token:this.user.user.token},success:function(e){var n=JSON.parse(e.data);0==n.code&&(1==i?(s.imgurlarr=s.imgurlarr.concat(n.fileurl),""!=s.imgurlarr&&t.hideLoading()):(s.lifevideo=n.fileurl,""!=s.lifevideo&&t.hideLoading(),console.log(s.lifevideo)))}})},postcontent:function(){if(""!=this.imgurlarr)if(""!=this.content)if(""!=this.lifevideo){var e={lifeimage:this.imgurlarr,token:this.user.user.token,lifecontent:this.content,lifecat:this.lifecat,lifevideo:this.lifevideo,pushid:this.pushid},i=this;t.request({url:a.default.hosturl+"life/savelife.html",method:"post",header:{"content-type":"application/x-www-form-urlencoded"},data:e,success:function(e){console.log(e.data),0==e.data.code?t.showToast({icon:"none",title:e.data.msg,success:function(){t.redirectTo({url:"tranInfo?lifecat="+i.lifecat})}}):t.showToast({icon:"none",title:e.data.msg})},fail:function(){t.showToast({icon:"none",title:"网络错误"})}})}else t.showToast({icon:"none",title:"请上传视频"});else t.showToast({icon:"none",title:"请选择备注信息"});else t.showToast({icon:"none",title:"请上传图片"})},delImage:function(t){console.log(t),this.imageList.splice(t,1),this.imgurlarr.splice(t,1),console.log(this.imgurlarr)},showmessage:function(t){this.content=this.comlist[t].content,this.isFix=!1},chooseVideo:function(){var t=this,e=plus.android.importClass("android.provider.MediaStore"),i=new(plus.android.importClass("android.content.Intent"))("android.media.action.VIDEO_CAPTURE");i.putExtra("android.intent.extra.videoQuality",1),i.putExtra("android.intent.extra.durationLimit",10);var s=plus.android.runtimeMainActivity();s.startActivityForResult(i,100),s.onActivityResult=function(i,n,a){var o=s;plus.android.importClass(a);var r=a.getData(),c=o.getContentResolver();plus.android.importClass(c);var l=c.query(r,null,null,null,null);plus.android.importClass(l),l.moveToFirst();var u=l.getColumnIndexOrThrow(e.Video.Media.DATA),d=l.getString(u);t.src=d,t.isshow=!t.isshow,t.uploadImage(d,2)}},chooseImage:function(){var e,i=(e=s.default.mark(function e(){var i,n,a=this;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=3,n=this,3!=this.imageList.length){e.next=8;break}return e.next=5,this.isFullImg();case 5:if(e.sent){e.next=8;break}return e.abrupt("return",!1);case 8:t.chooseImage({count:i-this.imageList.length,sourceType:["camera"],success:function(t){a.imageList=a.imageList.concat(t.tempFilePaths),t.tempFilePaths.forEach(function(t,e){n.uploadImage(t,1)})}});case 9:case"end":return e.stop()}},e,this)}),function(){var t=e.apply(this,arguments);return new Promise(function(e,i){return function s(n,a){try{var o=t[n](a),r=o.value}catch(t){return void i(t)}if(!o.done)return Promise.resolve(r).then(function(t){s("next",t)},function(t){s("throw",t)});e(r)}("next")})});return function(){return i.apply(this,arguments)}}(),isFullImg:function(){var e=this;return new Promise(function(i){t.showModal({content:"最多只能选择3张图片,是否清空现有图片？",success:function(t){t.confirm?(e.imageList=[],i(!0)):i(!1)},fail:function(){i(!1)}})})},previewImage:function(e){var i=e.target.dataset.src;t.previewImage({current:i,urls:this.imageList})}},onLoad:function(t){var e=JSON.parse(t.param);this.lifecat=e.lifecat,this.pushid=e.pushid,this.islogin()},onShow:function(){this.getcomlist()}}}).call(e,i(2).default)},41:function(t,e,i){"use strict";var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("view",{staticClass:"page"},[i("view",{staticClass:"header"},[i("view",{staticClass:"header-left",attrs:{eventid:"gcJ-0"},on:{tap:function(e){t.backs()}}},[i("text",{staticClass:"icon"},[t._v("")])]),i("view",{staticClass:"header-content"},[t._v("\n\t\t\t添加任务\n\t\t")]),i("view",{staticClass:"header-right"})]),i("view",{staticClass:"tab-title"},[i("view",{staticClass:"tab-title"},[i("view",{staticClass:"tab ",class:{select:!t.showVideo},attrs:{eventid:"Avg-1"},on:{click:function(e){t.showVideo=!1}}},[t._v("照片")]),i("view",{staticClass:"tab ",class:{select:t.showVideo},attrs:{eventid:"P7G-2"},on:{click:function(e){t.showVideo=!0}}},[t._v("视频")])])]),t.showVideo?i("view",[i("view",{staticClass:"imgList"},[t.isshow?i("view",{staticClass:"imgItem"},[i("video",{staticClass:"video",staticStyle:{height:"200px"},attrs:{src:t.src}})]):i("view",{staticClass:"imgItem imgItemBorder",attrs:{eventid:"GYn-6"},on:{tap:t.chooseVideo}},[i("view",{staticClass:"gIcon addIcon"},[t._v("\n\t\t\t\t\t\n\t\t\t\t")])])])]):i("view",[i("view",{staticClass:"imgList"},[t._l(t.imageList,function(e,s){return i("block",{key:s},[i("view",{staticClass:"imgItem"},[i("image",{staticClass:"imgsize",attrs:{src:e,"data-src":e,eventid:"yCN-3-"+s},on:{tap:t.previewImage}}),i("block",[i("image",{staticClass:"close",attrs:{src:"../../static/close.png",eventid:"KHh-4-"+s},on:{click:function(e){t.delImage(s)}}})]),i("view",{directives:[{name:"show",rawName:"v-show",value:t.imageshow,expression:"imageshow"}],staticClass:"spinner"},[i("image",{staticStyle:{width:"100px",height:"100px"},attrs:{src:"../../static/timg.gif"}})])],1)])}),i("view",{staticClass:"imgItem imgItemBorder",attrs:{eventid:"ikJ-5"},on:{tap:t.chooseImage}},[i("text",{staticClass:"gIcon addIcon"},[t._v("\n\t\t\t\t\t\n\t\t\t\t")])])],2)]),i("view",{staticClass:"remarks"},[i("view",{staticClass:"remarks-title"},[i("text",[t._v("备注消息")]),i("text",{staticClass:"gIcon",attrs:{eventid:"wdE-7"},on:{tap:function(e){t.isFix=!0}}},[t._v("")])]),t.isFix?i("view",{staticClass:"isFix"},[i("view",{staticClass:"fixmsg"},[i("view",{staticClass:"fix-title",attrs:{eventid:"RSQ-8"},on:{tap:function(e){t.ways("changyongyu")}}},[t._v("添加常用语")]),i("view",[i("block",t._l(t.comlist,function(e,s){return i("view",{key:s,staticClass:"fix-item",attrs:{eventid:"xiB-9-"+s},on:{click:function(e){t.showmessage(s)}}},[t._v(t._s(e.content))])}))],1),i("view",{staticClass:"fix-end",attrs:{eventid:"VPg-10"},on:{tap:function(e){t.isFix=!1}}},[t._v("取消")])])]):t._e(),i("view",{staticClass:"remarks-content"},[i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.content,expression:"content"}],staticClass:"textarea",attrs:{placeholder:"必填（1000字符以内)",eventid:"cGg-11"},domProps:{value:t.content},on:{input:function(e){e.target.composing||(t.content=e.target.value)}}})])]),i("button",{staticClass:"mgt40 btn",attrs:{eventid:"ozv-12"},on:{click:t.postcontent}},[t._v("保存")])],1)};s._withStripped=!0;var n={render:s,staticRenderFns:[]};e.a=n}},[34]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/train/add.js.map